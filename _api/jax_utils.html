<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>jax_utils package &mdash; AI Helpers Jax Utils 0.1.0a2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=7e4d6dd2"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="jax_utils" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2E68D9" >

          
          
          <a href="../index.html">
            
          </a>
              <div class="version">
                0.1.0a2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">jax_utils</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">jax_utils package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.common_tensor">jax_utils.common_tensor module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.common_tensor.check_ndim_in"><code class="docutils literal notranslate"><span class="pre">check_ndim_in()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.common_tensor.is_broadcastable"><code class="docutils literal notranslate"><span class="pre">is_broadcastable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.common_tensor.TensorAxes"><code class="docutils literal notranslate"><span class="pre">TensorAxes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.common_tensor.expand_dims_axis"><code class="docutils literal notranslate"><span class="pre">expand_dims_axis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike"><code class="docutils literal notranslate"><span class="pre">AverageableArrayLike</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.common_tensor.Tensor"><code class="docutils literal notranslate"><span class="pre">Tensor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.common_tensor.RegularizedArrayLikeCost"><code class="docutils literal notranslate"><span class="pre">RegularizedArrayLikeCost</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.compilation">jax_utils.compilation module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.compilation.JaxCompilableProtocol"><code class="docutils literal notranslate"><span class="pre">JaxCompilableProtocol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.compilation.BaseJaxCompilable"><code class="docutils literal notranslate"><span class="pre">BaseJaxCompilable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.compilation.jit_when_compilation_enabled"><code class="docutils literal notranslate"><span class="pre">jit_when_compilation_enabled()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.dynamics">jax_utils.dynamics module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.dynamics.JaxDynamics"><code class="docutils literal notranslate"><span class="pre">JaxDynamics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.dynamics.VectorizedJaxDynamics"><code class="docutils literal notranslate"><span class="pre">VectorizedJaxDynamics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.dynamics.RegularizedJaxDynamics"><code class="docutils literal notranslate"><span class="pre">RegularizedJaxDynamics</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.gradient">jax_utils.gradient module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.gradient.BaseGradientStep"><code class="docutils literal notranslate"><span class="pre">BaseGradientStep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.gradient.GradientStep"><code class="docutils literal notranslate"><span class="pre">GradientStep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.gradient.VectorizedGradientStep"><code class="docutils literal notranslate"><span class="pre">VectorizedGradientStep</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.jax_tensor">jax_utils.jax_tensor module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor"><code class="docutils literal notranslate"><span class="pre">JaxTensor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.jax_tensor.NonNegativeValues"><code class="docutils literal notranslate"><span class="pre">NonNegativeValues</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.jax_tensor.NonNegativeBudgetedValues"><code class="docutils literal notranslate"><span class="pre">NonNegativeBudgetedValues</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.jax_tensor.RegularizedJaxCost"><code class="docutils literal notranslate"><span class="pre">RegularizedJaxCost</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.markov_decision_process">jax_utils.markov_decision_process module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics"><code class="docutils literal notranslate"><span class="pre">Dynamics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.markov_decision_process.CostRegularizer"><code class="docutils literal notranslate"><span class="pre">CostRegularizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.markov_decision_process.RegularizedDynamics"><code class="docutils literal notranslate"><span class="pre">RegularizedDynamics</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.optim">jax_utils.optim module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.OptimizationState"><code class="docutils literal notranslate"><span class="pre">OptimizationState</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition"><code class="docutils literal notranslate"><span class="pre">OptimStoppingCondition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.OptimStoppingConditionsCombination"><code class="docutils literal notranslate"><span class="pre">OptimStoppingConditionsCombination</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.OptimStoppingConditionIntersection"><code class="docutils literal notranslate"><span class="pre">OptimStoppingConditionIntersection</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.OptimStoppingConditionUnion"><code class="docutils literal notranslate"><span class="pre">OptimStoppingConditionUnion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.MaxIterationsStoppingCondition"><code class="docutils literal notranslate"><span class="pre">MaxIterationsStoppingCondition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.MinIterationsStoppingCondition"><code class="docutils literal notranslate"><span class="pre">MinIterationsStoppingCondition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.MinDeltaActionStoppingCondition"><code class="docutils literal notranslate"><span class="pre">MinDeltaActionStoppingCondition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.MinDeltaCostStoppingCondition"><code class="docutils literal notranslate"><span class="pre">MinDeltaCostStoppingCondition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.CostHistory"><code class="docutils literal notranslate"><span class="pre">CostHistory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.optim.GradientDescentOptimizationLoop"><code class="docutils literal notranslate"><span class="pre">GradientDescentOptimizationLoop</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.pytree">jax_utils.pytree module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes"><code class="docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.pytree.pytree_to_axes"><code class="docutils literal notranslate"><span class="pre">pytree_to_axes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.tranform">jax_utils.tranform module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.tranform.scale_jax_tensor"><code class="docutils literal notranslate"><span class="pre">scale_jax_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.tranform.unscale_jax_tensor"><code class="docutils literal notranslate"><span class="pre">unscale_jax_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.tranform.JaxScaler"><code class="docutils literal notranslate"><span class="pre">JaxScaler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.typing">jax_utils.typing module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.typing.DataclassInstance"><code class="docutils literal notranslate"><span class="pre">DataclassInstance</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.typing.HashableIndexingOrSlicing"><code class="docutils literal notranslate"><span class="pre">HashableIndexingOrSlicing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.typing.HashableSlicing"><code class="docutils literal notranslate"><span class="pre">HashableSlicing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.typing.HashableIndexing"><code class="docutils literal notranslate"><span class="pre">HashableIndexing</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils.vectorization">jax_utils.vectorization module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.vectorization.JaxVectorizableProtocol"><code class="docutils literal notranslate"><span class="pre">JaxVectorizableProtocol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.vectorization.vectorize"><code class="docutils literal notranslate"><span class="pre">vectorize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes"><code class="docutils literal notranslate"><span class="pre">JaxDataclassNestedConvertibleToAxes</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jax_utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2E68D9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AI Helpers Jax Utils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">jax_utils</a></li>
      <li class="breadcrumb-item active">jax_utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_api/jax_utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="jax-utils-package">
<h1>jax_utils package<a class="headerlink" href="#jax-utils-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-jax_utils.common_tensor">
<span id="jax-utils-common-tensor-module"></span><h2>jax_utils.common_tensor module<a class="headerlink" href="#module-jax_utils.common_tensor" title="Link to this heading"></a></h2>
<p>Wrappers around numpy/jax arrays</p>
<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.common_tensor.check_ndim_in">
<span class="sig-name descname"><span class="pre">check_ndim_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_ndims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#check_ndim_in"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.check_ndim_in" title="Link to this definition"></a></dt>
<dd><p>Checks if the number of dimensions matches some allowed values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>Array</em>) – numpy or JAX array</p></li>
<li><p><strong>allowed_ndims</strong> (<em>Iterable</em><em>[</em><em>int</em><em>]</em>) – number of dimensions allowed for <code class="docutils literal notranslate"><span class="pre">array</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – when the number of dimensions of <code class="docutils literal notranslate"><span class="pre">array</span></code> is not present in <code class="docutils literal notranslate"><span class="pre">allowed_shapes</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.common_tensor.is_broadcastable">
<span class="sig-name descname"><span class="pre">is_broadcastable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#is_broadcastable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.is_broadcastable" title="Link to this definition"></a></dt>
<dd><p>Whether the shapes of 2 arrays/tensors can be
<a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">broadcasted</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape_1</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – shape of the 1st array</p></li>
<li><p><strong>shape_2</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – shape of the 2nd array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if and only if the 2 arrays/tensors can be broadcasted, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.common_tensor.TensorAxes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TensorAxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AbstractSet</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_min_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#TensorAxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.TensorAxes" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedSet</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<p>An ordered set of “named” array/tensor axes.</p>
<p>The position in the set defines the axis index in the tensor.</p>
<p>The first <code class="docutils literal notranslate"><span class="pre">len(self)</span> <span class="pre">-</span> <span class="pre">tensor_min_dim</span></code> axes are optional:
if absent, they are assumed to be “flattened”.</p>
<p>The reason for not making the last <code class="docutils literal notranslate"><span class="pre">tensor_min_dim</span></code> axes optional instead of the first
<code class="docutils literal notranslate"><span class="pre">len(self)</span> <span class="pre">-</span> <span class="pre">tensor_min_dim</span></code> axes is to follow the logic of array broadcasting (first dimension can be omitted).</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.TensorAxes.reverse_index">
<span class="sig-name descname"><span class="pre">reverse_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#TensorAxes.reverse_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.TensorAxes.reverse_index" title="Link to this definition"></a></dt>
<dd><p>Computes the index of element <code class="docutils literal notranslate"><span class="pre">key</span></code> but rather than return a non-negative integer like
method <code class="docutils literal notranslate"><span class="pre">index</span></code>, it returns a negative integer e.g., -1 if for the last element,
-2 for the penultimate element, …</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>T</em>) – any element present in <code class="docutils literal notranslate"><span class="pre">self</span></code> (which is an ordered set)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>negative integer corresponding to the position of <code class="docutils literal notranslate"><span class="pre">key</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code></dt><dd><p>(starting from the last and decrementing by 1 for each element)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.TensorAxes.mandatory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mandatory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OrderedSet</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.common_tensor.TensorAxes.mandatory" title="Link to this definition"></a></dt>
<dd><p>Returns:
OrderedSet[T]: ordered set of non-optional axes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.TensorAxes.optional">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">optional</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OrderedSet</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.common_tensor.TensorAxes.optional" title="Link to this definition"></a></dt>
<dd><p>Returns:
OrderedSet[T]: ordered set of optional axes.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.common_tensor.expand_dims_axis">
<span class="sig-name descname"><span class="pre">expand_dims_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.common_tensor.TensorAxes" title="jax_utils.common_tensor.TensorAxes"><span class="pre">TensorAxes</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AbstractSet</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#expand_dims_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.expand_dims_axis" title="Link to this definition"></a></dt>
<dd><p>Compute <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument to pass to <code class="docutils literal notranslate"><span class="pre">numpy.expand_dims(a,</span> <span class="pre">axis)</span></code> function when some axes in <code class="docutils literal notranslate"><span class="pre">tensor_axes</span></code>
are not present in the numpy array <code class="docutils literal notranslate"><span class="pre">a</span></code> (they are “flattened”).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor_axes</strong> (<a class="reference internal" href="#jax_utils.common_tensor.TensorAxes" title="jax_utils.common_tensor.TensorAxes"><em>TensorAxes</em></a><em>[</em><em>AxisType</em><em>]</em>) – some array/tensor axes</p></li>
<li><p><strong>missing_axes</strong> (<em>AbstractSet</em><em>[</em><em>AxisType</em><em>]</em>) – missing axes in the array/tensor</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – raises an error when <code class="docutils literal notranslate"><span class="pre">missing_axes</span></code> is not a subset of <code class="docutils literal notranslate"><span class="pre">tensor_axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument to pass to <code class="docutils literal notranslate"><span class="pre">numpy.expand_dims(a,</span> <span class="pre">axis)</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[int, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.common_tensor.AverageableArrayLike">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AverageableArrayLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#AverageableArrayLike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.AverageableArrayLike" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ArrayType_co</span></code>]</p>
<p>Shared interface of all classes with a <code class="docutils literal notranslate"><span class="pre">mean</span></code> method return a scalar array (corresponding to the mean values of
the initial array).</p>
<p>Example of classes implementing this interface: (jax) numpy arrays, …</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.AverageableArrayLike.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayType_co</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#AverageableArrayLike.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.AverageableArrayLike.mean" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Should return a scalar array</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ArrayType_co</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.typing.DataclassInstance" title="jax_utils.typing.DataclassInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataclassInstance</span></code></a>, <a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike" title="jax_utils.common_tensor.AverageableArrayLike"><code class="xref py py-class docutils literal notranslate"><span class="pre">AverageableArrayLike</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ArrayType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>]</p>
<p>A wrapper for numpy/jax arrays with the following additional features:</p>
<ul class="simple">
<li><p>axes are “named” to facilitate manipulation and debugging (an axis “name” could be a string or any other
hashable <code class="docutils literal notranslate"><span class="pre">AxisType</span></code>)</p></li>
<li><p>the returned <code class="docutils literal notranslate"><span class="pre">values</span></code> of the tensor can be different from the actual <code class="docutils literal notranslate"><span class="pre">array</span></code> given as input at construction,
this allows to easily implement “change of variables” (a.k.a., “substitution”)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_tensor_axes</strong> (<em>ClassVar</em><em>[</em><a class="reference internal" href="#jax_utils.common_tensor.TensorAxes" title="jax_utils.common_tensor.TensorAxes"><em>TensorAxes</em></a><em>[</em><em>AxisType</em><em>]</em><em>]</em>) – class attribute defining the axes of the <code class="docutils literal notranslate"><span class="pre">array</span></code></p></li>
<li><p><strong>array</strong> (<em>ArrayType</em>) – a (jax) numpy array containing all relevant data</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.array">
<span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ArrayType</span></em><a class="headerlink" href="#jax_utils.common_tensor.Tensor.array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.check_array">
<span class="sig-name descname"><span class="pre">check_array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.check_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.check_array" title="Link to this definition"></a></dt>
<dd><p>Check the validity of the <code class="docutils literal notranslate"><span class="pre">array</span></code> attribute at construction.
To be overriden if needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.getitem_from_axes">
<span class="sig-name descname"><span class="pre">getitem_from_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.getitem_from_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.getitem_from_axes" title="Link to this definition"></a></dt>
<dd><p>Analogue of method <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> but where array slicing/indexing is explicitly applied to named axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axes_keys</strong> (<em>Dict</em><em>[</em><em>AxisType</em><em>, </em><em>Any</em><em>]</em>) – a mapping between axes names and slices/list of indices/…</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> of the same type with restricted data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ArrayType</span></em><a class="headerlink" href="#jax_utils.common_tensor.Tensor.values" title="Link to this definition"></a></dt>
<dd><p>Override to apply transformations on <code class="docutils literal notranslate"><span class="pre">self.array</span></code> (“change of variable”).</p>
<p>For example, if one wants to manipulate (jax) tensors constrained to always have non-negative values in any
situation (even if the tensor gets updated by some gradient descent procedure for instance), then one can
override <code class="docutils literal notranslate"><span class="pre">values</span></code> by returning <code class="docutils literal notranslate"><span class="pre">jax.nn.relu(self.array)</span></code>.</p>
<p>By default <code class="docutils literal notranslate"><span class="pre">values</span></code> implements the identity i.e., returns <code class="docutils literal notranslate"><span class="pre">self.array</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the transformed <code class="docutils literal notranslate"><span class="pre">array</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ArrayType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.reverse_values">
<span class="sig-name descname"><span class="pre">reverse_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayType</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.reverse_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.reverse_values" title="Link to this definition"></a></dt>
<dd><p>Inverse of the transformation implemented in <code class="docutils literal notranslate"><span class="pre">values</span></code> property.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">self.array</span> <span class="pre">=</span> <span class="pre">self.values</span></code> so calling <code class="docutils literal notranslate"><span class="pre">values</span></code> is equivalent to calling <code class="docutils literal notranslate"><span class="pre">array</span></code>.</p>
<p>When the transformation mapping <code class="docutils literal notranslate"><span class="pre">array</span></code> to <code class="docutils literal notranslate"><span class="pre">values</span></code> is not the identity, <code class="docutils literal notranslate"><span class="pre">reverse_values</span></code> should be
overriden accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<em>ArrayType</em>) – the output of property <code class="docutils literal notranslate"><span class="pre">values</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the array obtained by apply the inverse transformation of</dt><dd><p><code class="docutils literal notranslate"><span class="pre">values</span></code></p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayType</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#jax_utils.common_tensor.Tensor.dtype" title="Link to this definition"></a></dt>
<dd><p>Get the type of <code class="docutils literal notranslate"><span class="pre">self.values</span></code></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.common_tensor.Tensor.shape" title="Link to this definition"></a></dt>
<dd><p>Get the shape of <code class="docutils literal notranslate"><span class="pre">self.values</span></code></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.common_tensor.Tensor.ndim" title="Link to this definition"></a></dt>
<dd><p>Get the number of dimensions of <code class="docutils literal notranslate"><span class="pre">self.values</span></code></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.common_tensor.TensorAxes" title="jax_utils.common_tensor.TensorAxes"><span class="pre">TensorAxes</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.common_tensor.Tensor.axes" title="Link to this definition"></a></dt>
<dd><p>Possible “named” axes of the tensor</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.actual_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">actual_axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.common_tensor.TensorAxes" title="jax_utils.common_tensor.TensorAxes"><span class="pre">TensorAxes</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.common_tensor.Tensor.actual_axes" title="Link to this definition"></a></dt>
<dd><p>Actual axes of the tensor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.mean" title="Link to this definition"></a></dt>
<dd><p>Compute the mean on <code class="docutils literal notranslate"><span class="pre">self.values</span></code> on specified axes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.mean_over_axes">
<span class="sig-name descname"><span class="pre">mean_over_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AbstractSet</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.mean_over_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.mean_over_axes" title="Link to this definition"></a></dt>
<dd><p>Averages <code class="docutils literal notranslate"><span class="pre">values</span></code> along one or several named axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axes</strong> (<em>AbstractSet</em><em>[</em><em>AxisType</em><em>]</em>) – axes along which the means are computed</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new array containing the mean <code class="docutils literal notranslate"><span class="pre">values</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[ArrayType, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.sum" title="Link to this definition"></a></dt>
<dd><p>Get the sum of the array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.sum_over_axes">
<span class="sig-name descname"><span class="pre">sum_over_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AbstractSet</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.sum_over_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.sum_over_axes" title="Link to this definition"></a></dt>
<dd><p>Sums <code class="docutils literal notranslate"><span class="pre">values</span></code> along one or several named axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axes</strong> (<em>AbstractSet</em><em>[</em><em>AxisType</em><em>]</em>) – axes along which the sums are computed</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new array containing the summed <code class="docutils literal notranslate"><span class="pre">values</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[ArrayType, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.has">
<span class="sig-name descname"><span class="pre">has</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.has"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.has" title="Link to this definition"></a></dt>
<dd><p>Whether <code class="docutils literal notranslate"><span class="pre">axis</span></code> is one of the possible axes of the tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>AxisType</em>) – a “named” axis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">axis</span></code> is one of the possible axes of the tensor, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.has_actual">
<span class="sig-name descname"><span class="pre">has_actual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.has_actual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.has_actual" title="Link to this definition"></a></dt>
<dd><p>Whether <code class="docutils literal notranslate"><span class="pre">axis</span></code> is one of the actual axes of the tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>AxisType</em>) – a “named” axis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">axis</span></code> is one of the actual axes of the tensor, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.index" title="Link to this definition"></a></dt>
<dd><p>Index of <code class="docutils literal notranslate"><span class="pre">axis</span></code> in tensor i.e., returns  <code class="docutils literal notranslate"><span class="pre">i</span></code> if and only if <code class="docutils literal notranslate"><span class="pre">axis</span></code> is the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th
dimension of the tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>AxisType</em>) – a “named” axis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corresponding index</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.reverse_index">
<span class="sig-name descname"><span class="pre">reverse_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.reverse_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.reverse_index" title="Link to this definition"></a></dt>
<dd><p>Index of <code class="docutils literal notranslate"><span class="pre">axis</span></code> in tensor but in reverse order i.e., returns  <code class="docutils literal notranslate"><span class="pre">-i</span></code> if and only if
<code class="docutils literal notranslate"><span class="pre">axis</span></code> is the <code class="docutils literal notranslate"><span class="pre">(n</span> <span class="pre">-</span> <span class="pre">i)</span></code>-th dimension of the tensor (with <code class="docutils literal notranslate"><span class="pre">n</span></code> the total number of dimension).
dimension of the tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>AxisType</em>) – a “named” axis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corresponding index in reverse order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.size" title="Link to this definition"></a></dt>
<dd><p>The size of a given <code class="docutils literal notranslate"><span class="pre">axis</span></code>. Returns 0 when the <code class="docutils literal notranslate"><span class="pre">axis</span></code> is “flattened”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>AxisType</em>) – a “named” axis</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <code class="docutils literal notranslate"><span class="pre">axis</span></code> is not a possible axis</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the size of <code class="docutils literal notranslate"><span class="pre">axis</span></code> (0 when the <code class="docutils literal notranslate"><span class="pre">axis</span></code> is “flattened”)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.Tensor.is_broadcastable_with">
<span class="sig-name descname"><span class="pre">is_broadcastable_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_tensor_or_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.common_tensor.Tensor" title="jax_utils.common_tensor.Tensor"><span class="pre">Tensor</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ArrayType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#Tensor.is_broadcastable_with"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.Tensor.is_broadcastable_with" title="Link to this definition"></a></dt>
<dd><p>Whether this tensor can be
<a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">broadcasted</a>
with <code class="docutils literal notranslate"><span class="pre">other_tensor_or_shape</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other_tensor_or_shape</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#jax_utils.common_tensor.Tensor" title="jax_utils.common_tensor.Tensor"><em>Tensor</em></a><em>[</em><em>ArrayType</em><em>, </em><em>AxisType</em><em>]</em><em>, </em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em><em>]</em>) – another
tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">True</span></code> if and only if this tensor can be broadcasted with <code class="docutils literal notranslate"><span class="pre">other_tensor_or_shape</span></code>,</dt><dd><p><code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.common_tensor.RegularizedArrayLikeCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RegularizedArrayLikeCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#RegularizedArrayLikeCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.RegularizedArrayLikeCost" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike" title="jax_utils.common_tensor.AverageableArrayLike"><code class="xref py py-class docutils literal notranslate"><span class="pre">AverageableArrayLike</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ArrayType</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ArrayType</span></code>]</p>
<p>Interface for “regularized” costs i.e., costs of the form:
<code class="docutils literal notranslate"><span class="pre">cost</span> <span class="pre">+</span> <span class="pre">lagrangian_coefficient</span> <span class="pre">*</span> <span class="pre">regularization</span></code></p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regularization_(mathematics)">More about regularization</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cost</strong> (<a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike" title="jax_utils.common_tensor.AverageableArrayLike"><em>AverageableArrayLike</em></a><em>[</em><em>ArrayType</em><em>]</em>) – an array-like collection of costs</p></li>
<li><p><strong>regularization</strong> (<a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike" title="jax_utils.common_tensor.AverageableArrayLike"><em>AverageableArrayLike</em></a><em>[</em><em>ArrayType</em><em>]</em>) – an array-like collection regularization costs</p></li>
<li><p><strong>lagrangian_coefficient</strong> (<em>Number</em>) – a non-negative number quantifying the regularization weight</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.common_tensor.RegularizedArrayLikeCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike" title="jax_utils.common_tensor.AverageableArrayLike"><span class="pre">AverageableArrayLike</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ArrayType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.common_tensor.RegularizedArrayLikeCost.cost" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.common_tensor.RegularizedArrayLikeCost.regularization">
<span class="sig-name descname"><span class="pre">regularization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike" title="jax_utils.common_tensor.AverageableArrayLike"><span class="pre">AverageableArrayLike</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ArrayType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.common_tensor.RegularizedArrayLikeCost.regularization" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.common_tensor.RegularizedArrayLikeCost.lagrangian_coefficient">
<span class="sig-name descname"><span class="pre">lagrangian_coefficient</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Number</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#jax_utils.common_tensor.RegularizedArrayLikeCost.lagrangian_coefficient" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.common_tensor.RegularizedArrayLikeCost.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/common_tensor.html#RegularizedArrayLikeCost.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.common_tensor.RegularizedArrayLikeCost.mean" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Should return a scalar array</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ArrayType_co</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.compilation">
<span id="jax-utils-compilation-module"></span><h2>jax_utils.compilation module<a class="headerlink" href="#module-jax_utils.compilation" title="Link to this heading"></a></h2>
<p>Classes and methods to to jit-compile functions involving jax arrays transformations</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.compilation.JaxCompilableProtocol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JaxCompilableProtocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/compilation.html#JaxCompilableProtocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.compilation.JaxCompilableProtocol" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>All classes implementing this interface should implement property <code class="docutils literal notranslate"><span class="pre">is_compilation_enabled</span></code>
indicating whether the methods involving JAX arrays should be
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/02-jitting.html">jit-compiled</a>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.compilation.JaxCompilableProtocol.is_compilation_enabled">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_compilation_enabled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#jax_utils.compilation.JaxCompilableProtocol.is_compilation_enabled" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.compilation.BaseJaxCompilable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BaseJaxCompilable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/compilation.html#BaseJaxCompilable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.compilation.BaseJaxCompilable" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.compilation.JaxCompilableProtocol" title="jax_utils.compilation.JaxCompilableProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxCompilableProtocol</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Subclassing <code class="docutils literal notranslate"><span class="pre">BaseCompilableJax</span></code> allows to easily enable/disable
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/02-jitting.html">jit-compilation</a>
of methods involving JAX arrays.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">with_optional_jax_jit</span></code> decorator to compile a method only when
<code class="docutils literal notranslate"><span class="pre">is_compilation_enabled</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (<code class="docutils literal notranslate"><span class="pre">False</span></code> by default).</p>
<p>To enable (resp. disable) jit-compilation, one only needs to call method <code class="docutils literal notranslate"><span class="pre">enable_compilation</span></code>
(resp. <code class="docutils literal notranslate"><span class="pre">disable_compilation</span></code>). By default, jit-compilation is disabled.</p>
<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.compilation.BaseJaxCompilable.is_compilation_enabled">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_compilation_enabled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#jax_utils.compilation.BaseJaxCompilable.is_compilation_enabled" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.compilation.BaseJaxCompilable.enable_compilation">
<span class="sig-name descname"><span class="pre">enable_compilation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/compilation.html#BaseJaxCompilable.enable_compilation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.compilation.BaseJaxCompilable.enable_compilation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.compilation.BaseJaxCompilable.disable_compilation">
<span class="sig-name descname"><span class="pre">disable_compilation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/compilation.html#BaseJaxCompilable.disable_compilation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.compilation.BaseJaxCompilable.disable_compilation" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.compilation.jit_when_compilation_enabled">
<span class="sig-name descname"><span class="pre">jit_when_compilation_enabled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">jax_jit_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/compilation.html#jit_when_compilation_enabled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.compilation.jit_when_compilation_enabled" title="Link to this definition"></a></dt>
<dd><p>Parametrized decorator for methods of classes implementing <code class="docutils literal notranslate"><span class="pre">CompilableJaxProtocol</span></code> interface.
Allows to <a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/02-jitting.html">jit-compile</a>
some methods only when compilation is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>decorator with parameters <code class="docutils literal notranslate"><span class="pre">jax_jit_args</span></code> specified</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable[[Callable], Callable]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jax_utils.dynamics">
<span id="jax-utils-dynamics-module"></span><h2>jax_utils.dynamics module<a class="headerlink" href="#module-jax_utils.dynamics" title="Link to this heading"></a></h2>
<p>High-level abstractions for decision problems (Markov Decision processes, etc…)
involving jax arrays transformations</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.dynamics.JaxDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JaxDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/dynamics.html#JaxDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.dynamics.JaxDynamics" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes" title="jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxDataclassNestedConvertibleToAxes</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>], <a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dynamics</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation_co</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation_co</span></code>]</p>
<p>A <a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics</span></code></a> involving Jax arrays transformations. The cost of such
dynamics can be differentiated w.r.t. the action (see method
<a class="reference internal" href="#jax_utils.dynamics.JaxDynamics.compute_gradient" title="jax_utils.dynamics.JaxDynamics.compute_gradient"><code class="xref py py-meth docutils literal notranslate"><span class="pre">jax_utils.dynamics.JaxDynamics.compute_gradient()</span></code></a>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.dynamics.JaxDynamics.scalar_cost">
<span class="sig-name descname"><span class="pre">scalar_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">State</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action_contra</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="../_modules/jax_utils/dynamics.html#JaxDynamics.scalar_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.dynamics.JaxDynamics.scalar_cost" title="Link to this definition"></a></dt>
<dd><p>Averages the cost associated to the dynamics of an MDP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>State</em>) – a state of the MDP</p></li>
<li><p><strong>action</strong> (<em>Action_contra</em>) – an action of the MDP</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a scalar Jax array corresponding to the mean cost</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.dynamics.JaxDynamics.compute_gradient">
<span class="sig-name descname"><span class="pre">compute_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">State</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action_contra</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action_contra</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/dynamics.html#JaxDynamics.compute_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.dynamics.JaxDynamics.compute_gradient" title="Link to this definition"></a></dt>
<dd><p>The cost of a <a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.dynamics.JaxDynamics</span></code></a> can always be differentiated
w.r.t. the action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>State</em>) – a state of the MDP</p></li>
<li><p><strong>action</strong> (<em>Action_contra</em>) – an action of the MDP</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the associated cost and the gradient of the action</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Cost_co, Action_contra]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.dynamics.VectorizedJaxDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VectorizedJaxDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><span class="pre">JaxDynamics</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action_contra</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation_co</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorized_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/dynamics.html#VectorizedJaxDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.dynamics.VectorizedJaxDynamics" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxDynamics</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation_co</span></code>]</p>
<p>A <a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.dynamics.JaxDynamics</span></code></a> that can be
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html">vectorized</a> over some “named” axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><em>JaxDynamics</em></a><em>[</em><em>AxisType</em><em>, </em><em>State</em><em>, </em><em>Action_contra</em><em>, </em><em>Cost_co</em><em>, </em><em>Observation_co</em><em>]</em>) – the
<a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.dynamics.JaxDynamics</span></code></a> to be vectorized</p></li>
<li><p><strong>vectorized_axis</strong> (<em>jdc.Static</em><em>[</em><em>AxisType</em><em>]</em>) – “named” axis to map over</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.dynamics.VectorizedJaxDynamics.dynamics">
<span class="sig-name descname"><span class="pre">dynamics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><span class="pre">JaxDynamics</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action_contra</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation_co</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.dynamics.VectorizedJaxDynamics.dynamics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.dynamics.VectorizedJaxDynamics.vectorized_axis">
<span class="sig-name descname"><span class="pre">vectorized_axis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.dynamics.VectorizedJaxDynamics.vectorized_axis" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.dynamics.RegularizedJaxDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RegularizedJaxDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><span class="pre">JaxDynamics</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType_contra</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_regularizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.markov_decision_process.CostRegularizer" title="jax_utils.markov_decision_process.CostRegularizer"><span class="pre">CostRegularizer</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RegularizedCost</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/dynamics.html#RegularizedJaxDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.dynamics.RegularizedJaxDynamics" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.markov_decision_process.RegularizedDynamics" title="jax_utils.markov_decision_process.RegularizedDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegularizedDynamics</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegularizedCost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation</span></code>], <a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxDynamics</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation</span></code>]</p>
<p>A <a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.dynamics.JaxDynamics</span></code></a> with cost regularization.
See also <a class="reference internal" href="#jax_utils.markov_decision_process.RegularizedDynamics" title="jax_utils.markov_decision_process.RegularizedDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.RegularizedDynamics</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><em>JaxDynamics</em></a><em>[</em><em>AxisType_contra</em><em>, </em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>Observation</em><em>]</em>) – the
<a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.dynamics.JaxDynamics</span></code></a> to be vectorized</p></li>
<li><p><strong>cost_regularizer</strong> (<a class="reference internal" href="#jax_utils.markov_decision_process.CostRegularizer" title="jax_utils.markov_decision_process.CostRegularizer"><em>CostRegularizer</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>Observation</em><em>, </em><em>RegularizedCost</em><em>]</em>) – a cost regularizer</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.dynamics.RegularizedJaxDynamics.dynamics">
<span class="sig-name descname"><span class="pre">dynamics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><span class="pre">JaxDynamics</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType_contra</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.dynamics.RegularizedJaxDynamics.dynamics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.dynamics.RegularizedJaxDynamics.cost_regularizer">
<span class="sig-name descname"><span class="pre">cost_regularizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.markov_decision_process.CostRegularizer" title="jax_utils.markov_decision_process.CostRegularizer"><span class="pre">CostRegularizer</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RegularizedCost</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.dynamics.RegularizedJaxDynamics.cost_regularizer" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.gradient">
<span id="jax-utils-gradient-module"></span><h2>jax_utils.gradient module<a class="headerlink" href="#module-jax_utils.gradient" title="Link to this heading"></a></h2>
<p>Classes and methods to compute the gradient of functions involving jax arrays transformations</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.gradient.BaseGradientStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BaseGradientStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/gradient.html#BaseGradientStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.BaseGradientStep" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes" title="jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxDataclassNestedConvertibleToAxes</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>Interface for gradient steps on the  <a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics</span></code></a> cost of a Markov
Decision Process.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.BaseGradientStep.init_optimizer">
<span class="sig-name descname"><span class="pre">init_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OptimizerState</span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#BaseGradientStep.init_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.BaseGradientStep.init_optimizer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.BaseGradientStep.compute_gradient">
<span class="sig-name descname"><span class="pre">compute_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">State_contra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#BaseGradientStep.compute_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.BaseGradientStep.compute_gradient" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.BaseGradientStep.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GradientUpdates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OptimizerState</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#BaseGradientStep.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.BaseGradientStep.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.gradient.GradientStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GradientStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">GradientTransformation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><span class="pre">JaxDynamics</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation_co</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/gradient.html#GradientStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.GradientStep" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGradientStep</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>The gradient step on the <a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics</span></code></a> cos
of a Markov Decision Process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<em>jdc.Static</em><em>[</em><em>optax.GradientTransformation</em><em>]</em>) – an optimizer (defining the
stochastic gradient descent variant: RMSProp, Adam, etc..)</p></li>
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><em>JaxDynamics</em></a><em>[</em><em>Any</em><em>, </em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost_co</em><em>, </em><em>Observation_co</em><em>]</em>) – an MDP dynamics</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.gradient.GradientStep.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jdc.Static</span><span class="p"><span class="pre">[</span></span><span class="pre">optax.GradientTransformation</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.gradient.GradientStep.optimizer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.gradient.GradientStep.dynamics">
<span class="sig-name descname"><span class="pre">dynamics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.dynamics.JaxDynamics" title="jax_utils.dynamics.JaxDynamics"><span class="pre">JaxDynamics</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation_co</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.gradient.GradientStep.dynamics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.GradientStep.init_optimizer">
<span class="sig-name descname"><span class="pre">init_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OptimizerState</span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#GradientStep.init_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.GradientStep.init_optimizer" title="Link to this definition"></a></dt>
<dd><p>Initialize optimizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>init_action</strong> (<em>Action</em>) – initial action before optimization starts</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>initialized optimizer state</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OptimizerState</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.GradientStep.compute_gradient">
<span class="sig-name descname"><span class="pre">compute_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">State</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#GradientStep.compute_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.GradientStep.compute_gradient" title="Link to this definition"></a></dt>
<dd><p>Given a state-action pair of the MDP, computes the cost and gradient
of the cost of a <code class="docutils literal notranslate"><span class="pre">dynamics</span></code> w.r.t. the action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>State</em>) – state of the MDP</p></li>
<li><p><strong>action</strong> (<em>Action</em>) – action of the MDP</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cost and gradient of the action</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Cost_co, Action]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.GradientStep.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GradientUpdates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OptimizerState</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#GradientStep.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.GradientStep.update" title="Link to this definition"></a></dt>
<dd><p>Update the action and optimizer state</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<em>Action</em>) – action of the MDP</p></li>
<li><p><strong>gradient_value</strong> (<em>GradientUpdates</em>) – gradient of the action</p></li>
<li><p><strong>opt_state</strong> (<em>OptimizerState</em>) – optimizer state</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the new action and optimizer state</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Action, OptimizerState]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.gradient.VectorizedGradientStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VectorizedGradientStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradient_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><span class="pre">BaseGradientStep</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorized_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/gradient.html#VectorizedGradientStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.VectorizedGradientStep" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGradientStep</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>A gradient step that is <a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html">vectorized</a> on a
specific axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gradient_step</strong> (<a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><em>BaseGradientStep</em></a><em>[</em><em>AxisType</em><em>, </em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost_co</em><em>, </em><em>OptimizerState</em><em>]</em>) – the gradient step to be
vectorized</p></li>
<li><p><strong>vectorized_axis</strong> (<em>jdc.Static</em><em>[</em><em>AxisType</em><em>]</em>) – “named” axis to be vectorized</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.gradient.VectorizedGradientStep.gradient_step">
<span class="sig-name descname"><span class="pre">gradient_step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><span class="pre">BaseGradientStep</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.gradient.VectorizedGradientStep.gradient_step" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.gradient.VectorizedGradientStep.vectorized_axis">
<span class="sig-name descname"><span class="pre">vectorized_axis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jdc.Static</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.gradient.VectorizedGradientStep.vectorized_axis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.VectorizedGradientStep.init_optimizer">
<span class="sig-name descname"><span class="pre">init_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OptimizerState</span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#VectorizedGradientStep.init_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.VectorizedGradientStep.init_optimizer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.VectorizedGradientStep.compute_gradient">
<span class="sig-name descname"><span class="pre">compute_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">State</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Cost_co</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#VectorizedGradientStep.compute_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.VectorizedGradientStep.compute_gradient" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.gradient.VectorizedGradientStep.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GradientUpdates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OptimizerState</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/gradient.html#VectorizedGradientStep.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.gradient.VectorizedGradientStep.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.jax_tensor">
<span id="jax-utils-jax-tensor-module"></span><h2>jax_utils.jax_tensor module<a class="headerlink" href="#module-jax_utils.jax_tensor" title="Link to this heading"></a></h2>
<p>Wrappers around jax arrays</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.JaxTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JaxTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#JaxTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.JaxTensor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.common_tensor.Tensor" title="jax_utils.common_tensor.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>], <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>]</p>
<p>Interface representing a <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> with a
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.array.html">JAX</a> <code class="docutils literal notranslate"><span class="pre">array</span></code>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">JaxTensor</span></code> is always “convertible to axes” (see
<a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes</span></code></a> interface) using
<a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes.convert_to_axes" title="jax_utils.pytree.ConvertibleToAxes.convert_to_axes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes.convert_to_axes()</span></code></a> method. When a <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> is
“converted to axes”, the  associated <code class="docutils literal notranslate"><span class="pre">array</span></code> attribute is no longer a JAX array but rather an integer indicating
the dimension index of the specified <code class="docutils literal notranslate"><span class="pre">axis</span></code> (argument of method <code class="docutils literal notranslate"><span class="pre">convert_to_axes</span></code>). If <code class="docutils literal notranslate"><span class="pre">axis</span></code> is
flattened or not present, <code class="docutils literal notranslate"><span class="pre">self.array</span></code> is set to <code class="docutils literal notranslate"><span class="pre">None</span></code> when converted to axes.</p>
<p>Converting a <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a> to axes is useful to determine the
<code class="docutils literal notranslate"><span class="pre">in_axes</span></code> and <code class="docutils literal notranslate"><span class="pre">out_axes</span></code> arguments of
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html">jax.vmap</a> and
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.pmap.html">jax.pmap</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>jnp.ndarray</em>) – a JAX array (or an optional integer when “converted to axes”)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.JaxTensor.array">
<span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#jax_utils.jax_tensor.JaxTensor.array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.JaxTensor.is_broadcastable_with">
<span class="sig-name descname"><span class="pre">is_broadcastable_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_tensor_or_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.common_tensor.Tensor" title="jax_utils.common_tensor.Tensor"><span class="pre">Tensor</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#JaxTensor.is_broadcastable_with"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.JaxTensor.is_broadcastable_with" title="Link to this definition"></a></dt>
<dd><p>Whether this tensor can be
<a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">broadcasted</a>
with <code class="docutils literal notranslate"><span class="pre">other_tensor_or_shape</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other_tensor_or_shape</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#jax_utils.common_tensor.Tensor" title="jax_utils.common_tensor.Tensor"><em>Tensor</em></a><em>[</em><em>ArrayType</em><em>, </em><em>AxisType</em><em>]</em><em>, </em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em><em>]</em>) – another
tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">True</span></code> if and only if this tensor can be broadcasted with <code class="docutils literal notranslate"><span class="pre">other_tensor_or_shape</span></code>,</dt><dd><p><code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.JaxTensor.from_flattened_axes">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_flattened_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flattened_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AbstractSet</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#JaxTensor.from_flattened_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.JaxTensor.from_flattened_axes" title="Link to this definition"></a></dt>
<dd><p>Constructor when some axes are “flattened” in <code class="docutils literal notranslate"><span class="pre">array</span></code>.</p>
<p>This method simply adds missing dimensions accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>jnp.ndarray</em>) – a JAX array</p></li>
<li><p><strong>flattened_axes</strong> (<em>AbstractSet</em><em>[</em><em>AxisType</em><em>]</em>) – the named axes that are “flattened”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of class <code class="docutils literal notranslate"><span class="pre">cls</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.JaxTensor.convert_to_axes">
<span class="sig-name descname"><span class="pre">convert_to_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#JaxTensor.convert_to_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.JaxTensor.convert_to_axes" title="Link to this definition"></a></dt>
<dd><p>Convert the <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a> object so that it can be passed as
the <code class="docutils literal notranslate"><span class="pre">in_axes</span></code> or <code class="docutils literal notranslate"><span class="pre">out_axes</span></code> arguments of
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html">jax.vmap</a> and
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.pmap.html">jax.pmap</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>Optional</em><em>[</em><em>AxisType</em><em>]</em>) – a “named” axis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>same object as <code class="docutils literal notranslate"><span class="pre">self</span></code> but with <code class="docutils literal notranslate"><span class="pre">array</span></code> replaced by the index of <code class="docutils literal notranslate"><span class="pre">axis</span></code> i.e.,</dt><dd><p>if <code class="docutils literal notranslate"><span class="pre">axis</span></code> corresponds to the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th dimension of <code class="docutils literal notranslate"><span class="pre">array</span></code>, then <code class="docutils literal notranslate"><span class="pre">array</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">i</span></code>,
if <code class="docutils literal notranslate"><span class="pre">axis</span></code> is a flattened axis or simply not present, then <code class="docutils literal notranslate"><span class="pre">array</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeValues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NonNegativeValues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#NonNegativeValues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeValues" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Interface to be used in combination with <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a> in order
to implement JAX tensors that are constrained to take non-negative <code class="docutils literal notranslate"><span class="pre">values</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>jnp.ndarray</em>) – a JAX array</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeValues.array">
<span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeValues.array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeValues.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeValues.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeValues.reverse_values">
<span class="sig-name descname"><span class="pre">reverse_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#NonNegativeValues.reverse_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeValues.reverse_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeBudgetedValues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NonNegativeBudgetedValues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#NonNegativeBudgetedValues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeBudgetedValues" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.jax_tensor.NonNegativeValues" title="jax_utils.jax_tensor.NonNegativeValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">NonNegativeValues</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Interface to be used in combination with <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a> in order to
implement JAX tensors that are constrained to both take non-negative <code class="docutils literal notranslate"><span class="pre">values</span></code> and have their
sum over the last axis bounded by  a maximal “budget” (<code class="docutils literal notranslate"><span class="pre">max_budget</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>jnp.ndarray</em>) – a JAX array</p></li>
<li><p><strong>max_budget</strong> (<em>Number</em>) – a non-negative number representing the maximum value that
the sum over the last axis can take</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeBudgetedValues.array">
<span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeBudgetedValues.array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeBudgetedValues.max_budget">
<span class="sig-name descname"><span class="pre">max_budget</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Number</span></em><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeBudgetedValues.max_budget" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeBudgetedValues.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeBudgetedValues.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.NonNegativeBudgetedValues.reverse_values">
<span class="sig-name descname"><span class="pre">reverse_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#NonNegativeBudgetedValues.reverse_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.NonNegativeBudgetedValues.reverse_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.RegularizedJaxCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RegularizedJaxCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JaxCostType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JaxRegularizedCostType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lagrangian_coefficient</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">Number</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#RegularizedJaxCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.RegularizedJaxCost" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.common_tensor.RegularizedArrayLikeCost" title="jax_utils.common_tensor.RegularizedArrayLikeCost"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegularizedArrayLikeCost</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>], <a class="reference internal" href="#jax_utils.compilation.BaseJaxCompilable" title="jax_utils.compilation.BaseJaxCompilable"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseJaxCompilable</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">JaxCostType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">JaxRegularizedCostType</span></code>]</p>
<p>Interface for “regularized” JAX costs i.e., costs of the form:
<code class="docutils literal notranslate"><span class="pre">cost</span> <span class="pre">+</span> <span class="pre">lagrangian_coefficient</span> <span class="pre">*</span> <span class="pre">regularization</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cost</strong> (<em>JaxCostType</em>) – an JAX array of costs</p></li>
<li><p><strong>regularization</strong> (<em>JaxRegularizedCostType</em>) – a JAX array of regularization costs</p></li>
<li><p><strong>lagrangian_coefficient</strong> (<em>jdc.Static</em><em>[</em><em>Number</em><em>]</em>) – a non-negative number quantifying the
regularization weight</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.RegularizedJaxCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">JaxCostType</span></em><a class="headerlink" href="#jax_utils.jax_tensor.RegularizedJaxCost.cost" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.RegularizedJaxCost.regularization">
<span class="sig-name descname"><span class="pre">regularization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">JaxRegularizedCostType</span></em><a class="headerlink" href="#jax_utils.jax_tensor.RegularizedJaxCost.regularization" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.RegularizedJaxCost.lagrangian_coefficient">
<span class="sig-name descname"><span class="pre">lagrangian_coefficient</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">Number</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#jax_utils.jax_tensor.RegularizedJaxCost.lagrangian_coefficient" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.jax_tensor.RegularizedJaxCost.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="../_modules/jax_utils/jax_tensor.html#RegularizedJaxCost.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.jax_tensor.RegularizedJaxCost.mean" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Should return a scalar array</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ArrayType_co</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.markov_decision_process">
<span id="jax-utils-markov-decision-process-module"></span><h2>jax_utils.markov_decision_process module<a class="headerlink" href="#module-jax_utils.markov_decision_process" title="Link to this heading"></a></h2>
<p>High-level abstractions for decision problems (Markov Decision processes, etc…)</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.markov_decision_process.Dynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Dynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/markov_decision_process.html#Dynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.markov_decision_process.Dynamics" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation_co</span></code>]</p>
<p>Interface defining the dynamics of a
<a class="reference external" href="https://en.wikipedia.org/wiki/Partially_observable_Markov_decision_process">(Partially Observable)</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Markov_decision_process">Markov Decision Process</a>.</p>
<p>When an “agent” interacting with the (PO)MDP plays an “action” (a.k.a. “control”)
in a given “state”, the (PO)MDP transitions to a new state and the agent observes
some signal/feedback in the form of a “cost”/”reward” as well as additional “observations”.</p>
<p>A <cite>Dynamics</cite> is therefore a callable that maps a state-action pair to a state-cost-observation tuple.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.markov_decision_process.CostRegularizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CostRegularizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/markov_decision_process.html#CostRegularizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.markov_decision_process.CostRegularizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation_contra</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost_co</span></code>]</p>
<p>Interface for callables that map any state-action-cost-observation tuple to a new “regularized” cost.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regularization_(mathematics)">More about regularization</a>.</p>
<p>Example: one may want to penalize <cite>action</cite> with high norms, etc…</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.markov_decision_process.RegularizedDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RegularizedDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/markov_decision_process.html#RegularizedDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.markov_decision_process.RegularizedDynamics" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dynamics</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegularizedCost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegularizedCost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation</span></code>]</p>
<p>Interface defining a wrapper around class <a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics</span></code></a> that allows to add
a regularization to the cost.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">RegularizedDynamics</span></code> is itself a <code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics`</span></code>.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regularization_(mathematics)">More about regularization</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><em>Dynamics</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>Observation</em><em>]</em>) – callable defining the dynamics of a (PO)MDP</p></li>
<li><p><strong>cost_regularizer</strong> (<a class="reference internal" href="#jax_utils.markov_decision_process.CostRegularizer" title="jax_utils.markov_decision_process.CostRegularizer"><em>CostRegularizer</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>Observation</em><em>, </em><em>RegularizedCost</em><em>]</em>) – callable</p></li>
<li><p><strong>transformation</strong> (<em>defining a cost</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.markov_decision_process.RegularizedDynamics.dynamics">
<span class="sig-name descname"><span class="pre">dynamics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><span class="pre">Dynamics</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.markov_decision_process.RegularizedDynamics.dynamics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.markov_decision_process.RegularizedDynamics.cost_regularizer">
<span class="sig-name descname"><span class="pre">cost_regularizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.markov_decision_process.CostRegularizer" title="jax_utils.markov_decision_process.CostRegularizer"><span class="pre">CostRegularizer</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Observation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RegularizedCost</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.markov_decision_process.RegularizedDynamics.cost_regularizer" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.optim">
<span id="jax-utils-optim-module"></span><h2>jax_utils.optim module<a class="headerlink" href="#module-jax_utils.optim" title="Link to this heading"></a></h2>
<p>Classes and methods to optimize functions involving jax arrays transformations via gradient descent</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.OptimizationState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OptimizationState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">State</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cost</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OptimizerState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimizationState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimizationState" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>The current state of an iterative optimization procedure involving the
<a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics</span></code></a>
of a Markov Decision Process (typically a cost minimization).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<em>int</em>) – the current iteration step</p></li>
<li><p><strong>state</strong> (<em>State</em>) – the MDP state</p></li>
<li><p><strong>action</strong> (<em>Action</em>) – the MDP current action</p></li>
<li><p><strong>cost</strong> (<em>Optional</em><em>[</em><em>Cost</em><em>]</em><em>, </em><em>optional</em>) – the current cost associated to the state-action pair. Defaults to None.</p></li>
<li><p><strong>optimizer_state</strong> (<em>Optional</em><em>[</em><em>OptimizerState</em><em>]</em><em>, </em><em>optional</em>) – The current <code class="docutils literal notranslate"><span class="pre">optax.OptState</span></code>. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimizationState.iteration">
<span class="sig-name descname"><span class="pre">iteration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.optim.OptimizationState.iteration" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimizationState.state">
<span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">State</span></em><a class="headerlink" href="#jax_utils.optim.OptimizationState.state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimizationState.action">
<span class="sig-name descname"><span class="pre">action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Action</span></em><a class="headerlink" href="#jax_utils.optim.OptimizationState.action" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimizationState.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Cost</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#jax_utils.optim.OptimizationState.cost" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimizationState.optimizer_state">
<span class="sig-name descname"><span class="pre">optimizer_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#jax_utils.optim.OptimizationState.optimizer_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.optim.OptimizationState.scalar_cost">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scalar_cost</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#jax_utils.optim.OptimizationState.scalar_cost" title="Link to this definition"></a></dt>
<dd><p>Returns the average <code class="docutils literal notranslate"><span class="pre">self.cost</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>average cost</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingCondition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OptimStoppingCondition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingCondition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingCondition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.compilation.BaseJaxCompilable" title="jax_utils.compilation.BaseJaxCompilable"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseJaxCompilable</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>Interface for all stopping conditions of an iterative optimization procedure involving the
<a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics</span></code></a> of a Markov Decision Process (typically a cost minimization).</p>
<p>The stopping condition depends on an <code class="docutils literal notranslate"><span class="pre">OptimizationState</span></code> provided as input but may
also collect information over steps.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingCondition.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingCondition.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingCondition.stop" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean inidicating whether the optimization procedure should be stopped.
This class should be overriven in every concrete class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True`</cite> if the optimization procedure should be stopped, <cite>False`</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingCondition.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingCondition.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingCondition.reset" title="Link to this definition"></a></dt>
<dd><p>Resets the stopping condition to an initial configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingCondition.nb_iterations_upper_bound">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nb_iterations_upper_bound</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingCondition.nb_iterations_upper_bound" title="Link to this definition"></a></dt>
<dd><p>An upper bound on the maximal number of iterations. Default is 1e20.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionsCombination">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OptimStoppingConditionsCombination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionsCombination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionsCombination" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimStoppingCondition</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>This interface represents the combination of 2 stopping conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stopping_condition_1</strong> (<a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><em>OptimStoppingCondition</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a stopping condition</p></li>
<li><p><strong>stopping_condition_2</strong> (<a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><em>OptimStoppingCondition</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a stopping condition</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionsCombination.stopping_condition_1">
<span class="sig-name descname"><span class="pre">stopping_condition_1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionsCombination.stopping_condition_1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionsCombination.stopping_condition_2">
<span class="sig-name descname"><span class="pre">stopping_condition_2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionsCombination.stopping_condition_2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionsCombination.enable_compilation">
<span class="sig-name descname"><span class="pre">enable_compilation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionsCombination.enable_compilation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionsCombination.enable_compilation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionsCombination.disable_compilation">
<span class="sig-name descname"><span class="pre">disable_compilation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionsCombination.disable_compilation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionsCombination.disable_compilation" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionIntersection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OptimStoppingConditionIntersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stopping_condition_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopping_condition_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionIntersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionIntersection" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.optim.OptimStoppingConditionsCombination" title="jax_utils.optim.OptimStoppingConditionsCombination"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimStoppingConditionsCombination</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>A combination of 2 stopping conditions using an “AND” operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stopping_condition_1</strong> (<a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><em>OptimStoppingCondition</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a stopping condition</p></li>
<li><p><strong>stopping_condition_2</strong> (<a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><em>OptimStoppingCondition</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a stopping condition</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionIntersection.stopping_condition_1">
<span class="sig-name descname"><span class="pre">stopping_condition_1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionIntersection.stopping_condition_1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionIntersection.stopping_condition_2">
<span class="sig-name descname"><span class="pre">stopping_condition_2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionIntersection.stopping_condition_2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionIntersection.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionIntersection.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionIntersection.stop" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean inidicating whether the optimization procedure should be stopped.
This class should be overriven in every concrete class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True`</cite> if the optimization procedure should be stopped, <cite>False`</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionIntersection.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jax_utils.optim.OptimStoppingConditionIntersection" title="jax_utils.optim.OptimStoppingConditionIntersection"><span class="pre">OptimStoppingConditionIntersection</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionIntersection.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionIntersection.reset" title="Link to this definition"></a></dt>
<dd><p>Resets the stopping condition to an initial configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionIntersection.nb_iterations_upper_bound">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nb_iterations_upper_bound</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionIntersection.nb_iterations_upper_bound" title="Link to this definition"></a></dt>
<dd><p>An upper bound on the maximal number of iterations. Default is 1e20.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionUnion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OptimStoppingConditionUnion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stopping_condition_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopping_condition_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionUnion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionUnion" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.optim.OptimStoppingConditionsCombination" title="jax_utils.optim.OptimStoppingConditionsCombination"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimStoppingConditionsCombination</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>A combination of 2 stopping conditions using an “OR” operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stopping_condition_1</strong> (<a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><em>OptimStoppingCondition</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a stopping condition</p></li>
<li><p><strong>stopping_condition_2</strong> (<a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><em>OptimStoppingCondition</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a stopping condition</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionUnion.stopping_condition_1">
<span class="sig-name descname"><span class="pre">stopping_condition_1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionUnion.stopping_condition_1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionUnion.stopping_condition_2">
<span class="sig-name descname"><span class="pre">stopping_condition_2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionUnion.stopping_condition_2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionUnion.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionUnion.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionUnion.stop" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean inidicating whether the optimization procedure should be stopped.
This class should be overriven in every concrete class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True`</cite> if the optimization procedure should be stopped, <cite>False`</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionUnion.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jax_utils.optim.OptimStoppingConditionUnion" title="jax_utils.optim.OptimStoppingConditionUnion"><span class="pre">OptimStoppingConditionUnion</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#OptimStoppingConditionUnion.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionUnion.reset" title="Link to this definition"></a></dt>
<dd><p>Resets the stopping condition to an initial configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.optim.OptimStoppingConditionUnion.nb_iterations_upper_bound">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nb_iterations_upper_bound</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.optim.OptimStoppingConditionUnion.nb_iterations_upper_bound" title="Link to this definition"></a></dt>
<dd><p>An upper bound on the maximal number of iterations. Default is 1e20.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.MaxIterationsStoppingCondition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaxIterationsStoppingCondition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#MaxIterationsStoppingCondition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MaxIterationsStoppingCondition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimStoppingCondition</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>A stopping condition that stops when the number of iterations exceeds a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_iterations</strong> (<em>int</em>) – maximal number of iterations before the stopping condition is raised</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.MaxIterationsStoppingCondition.max_iterations">
<span class="sig-name descname"><span class="pre">max_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.optim.MaxIterationsStoppingCondition.max_iterations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.MaxIterationsStoppingCondition.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#MaxIterationsStoppingCondition.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MaxIterationsStoppingCondition.stop" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean inidicating whether the optimization procedure should be stopped.
This class should be overriven in every concrete class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True`</cite> if the optimization procedure should be stopped, <cite>False`</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.optim.MaxIterationsStoppingCondition.nb_iterations_upper_bound">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nb_iterations_upper_bound</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.optim.MaxIterationsStoppingCondition.nb_iterations_upper_bound" title="Link to this definition"></a></dt>
<dd><p>An upper bound on the maximal number of iterations. Default is 1e20.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.MinIterationsStoppingCondition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MinIterationsStoppingCondition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinIterationsStoppingCondition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinIterationsStoppingCondition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimStoppingCondition</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>A stopping condition that continues as long as the number of iterations is below a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>min_iterations</strong> (<em>int</em>) – minimal number of iterations before the stopping condition is raised</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.MinIterationsStoppingCondition.min_iterations">
<span class="sig-name descname"><span class="pre">min_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#jax_utils.optim.MinIterationsStoppingCondition.min_iterations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.MinIterationsStoppingCondition.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinIterationsStoppingCondition.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinIterationsStoppingCondition.stop" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean inidicating whether the optimization procedure should be stopped.
This class should be overriven in every concrete class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True`</cite> if the optimization procedure should be stopped, <cite>False`</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaActionStoppingCondition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MinDeltaActionStoppingCondition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinDeltaActionStoppingCondition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinDeltaActionStoppingCondition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimStoppingCondition</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">JaxTensorType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>Stops when the action stops significantly changing (as defined by relative &amp; absolute tolerance).
The previous action is saved in memory to compare it to the new action.</p>
<p>The delta between previous and new action is then compared to absolute and relative tolerance i.e, the
stopping condition is raised when:
<code class="docutils literal notranslate"><span class="pre">all(abs(new_action</span> <span class="pre">-</span> <span class="pre">previous_action)</span> <span class="pre">&lt;=</span> <span class="pre">absolute</span> <span class="pre">tolerance</span> <span class="pre">+</span> <span class="pre">relative_tolerance</span> <span class="pre">*</span> <span class="pre">maximum(abs(new_action),</span>
<span class="pre">abs(previous_action)))</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relative_tolerance</strong> (<em>jnp.ndarray</em>) – relative tolerance for action variations. Default is 1e-6.</p></li>
<li><p><strong>absolute_tolerance</strong> (<em>jnp.ndarray</em>) – absolute tolerance for action variations. Default is 1e-6.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaActionStoppingCondition.relative_tolerance">
<span class="sig-name descname"><span class="pre">relative_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></em><a class="headerlink" href="#jax_utils.optim.MinDeltaActionStoppingCondition.relative_tolerance" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaActionStoppingCondition.absolute_tolerance">
<span class="sig-name descname"><span class="pre">absolute_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></em><a class="headerlink" href="#jax_utils.optim.MinDeltaActionStoppingCondition.absolute_tolerance" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaActionStoppingCondition.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">JaxTensorType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinDeltaActionStoppingCondition.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinDeltaActionStoppingCondition.stop" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean inidicating whether the optimization procedure should be stopped.
This class should be overriven in every concrete class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True`</cite> if the optimization procedure should be stopped, <cite>False`</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaActionStoppingCondition.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jax_utils.optim.MinDeltaActionStoppingCondition" title="jax_utils.optim.MinDeltaActionStoppingCondition"><span class="pre">MinDeltaActionStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">JaxTensorType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinDeltaActionStoppingCondition.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinDeltaActionStoppingCondition.reset" title="Link to this definition"></a></dt>
<dd><p>Resets the stopping condition to an initial configuration.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaCostStoppingCondition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MinDeltaCostStoppingCondition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinDeltaCostStoppingCondition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinDeltaCostStoppingCondition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimStoppingCondition</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>Stops when the cost stops significantly decreasing (as defined by relative &amp; absolute tolerance).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">window_length</span></code> last cost values are saved in memory and the stopping condition is raised when the delta
between the min and max of these values is below a threshold i.e., when:
<code class="docutils literal notranslate"><span class="pre">all(maximum(last_window_length_costs)</span> <span class="pre">-</span> <span class="pre">minimum(last_window_length_costs)</span> <span class="pre">&lt;</span> <span class="pre">absolute_tolerance</span> <span class="pre">+</span>
<span class="pre">relative_tolerance</span> <span class="pre">*</span> <span class="pre">minimum(last_window_length_costs))</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relative_tolerance</strong> (<em>jnp.ndarray</em>) – relative tolerance for cost variations. Default is 1e-6.</p></li>
<li><p><strong>absolute_tolerance</strong> (<em>jnp.ndarray</em>) – absolute tolerance for cost variations. Default is 1e-6.</p></li>
<li><p><strong>window_length</strong> (<em>int</em>) – maximal length of the queue storing the past history of costs (costs older than
<code class="docutils literal notranslate"><span class="pre">window_length</span></code> time steps are discarded)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaCostStoppingCondition.relative_tolerance">
<span class="sig-name descname"><span class="pre">relative_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></em><a class="headerlink" href="#jax_utils.optim.MinDeltaCostStoppingCondition.relative_tolerance" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaCostStoppingCondition.absolute_tolerance">
<span class="sig-name descname"><span class="pre">absolute_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array(1.e-06,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></em><a class="headerlink" href="#jax_utils.optim.MinDeltaCostStoppingCondition.absolute_tolerance" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaCostStoppingCondition.window_length">
<span class="sig-name descname"><span class="pre">window_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#jax_utils.optim.MinDeltaCostStoppingCondition.window_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaCostStoppingCondition.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinDeltaCostStoppingCondition.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinDeltaCostStoppingCondition.stop" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean inidicating whether the optimization procedure should be stopped.
This class should be overriven in every concrete class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True`</cite> if the optimization procedure should be stopped, <cite>False`</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.MinDeltaCostStoppingCondition.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jax_utils.optim.MinDeltaCostStoppingCondition" title="jax_utils.optim.MinDeltaCostStoppingCondition"><span class="pre">MinDeltaCostStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#MinDeltaCostStoppingCondition.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.MinDeltaCostStoppingCondition.reset" title="Link to this definition"></a></dt>
<dd><p>Resets the stopping condition to an initial configuration.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.CostHistory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CostHistory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initlist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#CostHistory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.CostHistory" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UserList</span></code>[<a class="reference internal" href="#jax_utils.common_tensor.AverageableArrayLike" title="jax_utils.common_tensor.AverageableArrayLike"><code class="xref py py-class docutils literal notranslate"><span class="pre">AverageableArrayLike</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>]]</p>
<p>List of costs (typically jax arrays)</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.CostHistory.scalar_costs">
<span class="sig-name descname"><span class="pre">scalar_costs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#CostHistory.scalar_costs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.CostHistory.scalar_costs" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of cost means</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.CostHistory.plot_scalar_costs">
<span class="sig-name descname"><span class="pre">plot_scalar_costs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#CostHistory.plot_scalar_costs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.CostHistory.plot_scalar_costs" title="Link to this definition"></a></dt>
<dd><p>Plots cost history</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.optim.GradientDescentOptimizationLoop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GradientDescentOptimizationLoop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradient_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><span class="pre">BaseGradientStep</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopping_condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/optim.html#GradientDescentOptimizationLoop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.GradientDescentOptimizationLoop" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">State</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cost</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerState</span></code>]</p>
<p>Gradient descent optimization procedure involving the <a class="reference internal" href="#jax_utils.markov_decision_process.Dynamics" title="jax_utils.markov_decision_process.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.markov_decision_process.Dynamics</span></code></a>
of a Markov Decision Process. This class is a callable that recursively applies <code class="docutils literal notranslate"><span class="pre">gradient_step</span></code> until
a <code class="docutils literal notranslate"><span class="pre">stopping_condition</span></code> is met.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gradient_step</strong> (<a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><em>BaseGradientStep</em></a><em>[</em><em>AxisType</em><em>, </em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a gradient step</p></li>
<li><p><strong>stopping_condition</strong> (<a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><em>OptimStoppingCondition</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – a stopping condition</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.GradientDescentOptimizationLoop.gradient_step">
<span class="sig-name descname"><span class="pre">gradient_step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.gradient.BaseGradientStep" title="jax_utils.gradient.BaseGradientStep"><span class="pre">BaseGradientStep</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.GradientDescentOptimizationLoop.gradient_step" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.optim.GradientDescentOptimizationLoop.stopping_condition">
<span class="sig-name descname"><span class="pre">stopping_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimStoppingCondition" title="jax_utils.optim.OptimStoppingCondition"><span class="pre">OptimStoppingCondition</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.optim.GradientDescentOptimizationLoop.stopping_condition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.optim.GradientDescentOptimizationLoop.resume">
<span class="sig-name descname"><span class="pre">resume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimization_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><span class="pre">OptimizationState</span></a><span class="p"><span class="pre">[</span></span><span class="pre">State</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Action</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Cost</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">OptimizerState</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jax_utils.optim.CostHistory" title="jax_utils.optim.CostHistory"><span class="pre">CostHistory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/optim.html#GradientDescentOptimizationLoop.resume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.optim.GradientDescentOptimizationLoop.resume" title="Link to this definition"></a></dt>
<dd><p>Resume optimization loop from <code class="docutils literal notranslate"><span class="pre">optimization_state</span></code> (cold start).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimization_state</strong> (<a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState"><em>OptimizationState</em></a><em>[</em><em>State</em><em>, </em><em>Action</em><em>, </em><em>Cost</em><em>, </em><em>OptimizerState</em><em>]</em>) – state from which to resume the
optimization procedure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>same outputs as <code class="xref py py-meth docutils literal notranslate"><span class="pre">GradientDescentOptimizationLoop.__call__()</span></code>  # pylint: disable=line-too-long</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState">OptimizationState</a>[State, Action, Cost, OptimizerState], <a class="reference internal" href="#jax_utils.optim.OptimizationState" title="jax_utils.optim.OptimizationState">OptimizationState</a>[State, Action, Cost,OptimizerState], <a class="reference internal" href="#jax_utils.optim.CostHistory" title="jax_utils.optim.CostHistory">CostHistory</a>,]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.pytree">
<span id="jax-utils-pytree-module"></span><h2>jax_utils.pytree module<a class="headerlink" href="#module-jax_utils.pytree" title="Link to this heading"></a></h2>
<p>Classes and methods to easily map pytrees to axes (e.g., for vectorization)</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.pytree.ConvertibleToAxes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConvertibleToAxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/pytree.html#ConvertibleToAxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.pytree.ConvertibleToAxes" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>]</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.pytree.ConvertibleToAxes.convert_to_axes">
<span class="sig-name descname"><span class="pre">convert_to_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType_contra</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/pytree.html#ConvertibleToAxes.convert_to_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.pytree.ConvertibleToAxes.convert_to_axes" title="Link to this definition"></a></dt>
<dd><p>Returns an object that can be used in argument <code class="docutils literal notranslate"><span class="pre">in_axes</span></code> or <code class="docutils literal notranslate"><span class="pre">out_axes</span></code> of
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html">jax.vmap</a>
or <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.pmap.html">jax.pmap</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>Optional</em><em>[</em><em>AxisType_contra</em><em>]</em>) – a “named” axis over which to apply
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html">vectorization</a>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>same object as <code class="docutils literal notranslate"><span class="pre">self</span></code> but with all array-like objects replaced by axes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.pytree.pytree_to_axes">
<span class="sig-name descname"><span class="pre">pytree_to_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pytree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorized_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/pytree.html#pytree_to_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.pytree.pytree_to_axes" title="Link to this definition"></a></dt>
<dd><p>Transform all the <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a> leafs of a given
<a class="reference external" href="https://jax.readthedocs.io/en/latest/pytrees.html">pytree</a> to axes by applying method
<a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes.convert_to_axes" title="jax_utils.pytree.ConvertibleToAxes.convert_to_axes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConvertibleToAxes.convert_to_axes()</span></code></a>. This is useful for
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html">vectorizing</a> functions
involving <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pytree</strong> (<em>Any</em>) – any Python pytree containing <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a> leafs</p></li>
<li><p><strong>vectorized_axis</strong> (<em>AxisType</em>) – <p>a “named” axis over which to apply
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html">vectorization</a></p>
</p></li>
<li><p><strong>default_axis</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – A default axis value for leafs that are not <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a>.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>same pytree as given in input but where all <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a> are converted to axes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jax_utils.tranform">
<span id="jax-utils-tranform-module"></span><h2>jax_utils.tranform module<a class="headerlink" href="#module-jax_utils.tranform" title="Link to this heading"></a></h2>
<p>Jax arrays transformations (scaling, …)</p>
<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.tranform.scale_jax_tensor">
<span class="sig-name descname"><span class="pre">scale_jax_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><span class="pre">JaxTensor</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><span class="pre">JaxTensor</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/tranform.html#scale_jax_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.tranform.scale_jax_tensor" title="Link to this definition"></a></dt>
<dd><p>Scale the <code class="docutils literal notranslate"><span class="pre">values</span></code> of a <code class="docutils literal notranslate"><span class="pre">JaxTensor</span></code> i.e., multiply <code class="docutils literal notranslate"><span class="pre">values</span></code> by <code class="docutils literal notranslate"><span class="pre">scaling_factor</span></code>.
Note that property <code class="docutils literal notranslate"><span class="pre">values</span></code> in <code class="docutils literal notranslate"><span class="pre">JaxTensor</span></code> differ from attribute <code class="docutils literal notranslate"><span class="pre">array</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><em>JaxTensor</em></a><em>[</em><em>AxisType</em><em>]</em>) – jax tensor to be scaled</p></li>
<li><p><strong>scaling_factor</strong> (<em>jnp.ndarray</em>) – the scaling factors to apply for scaling</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>scaled jax tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor">JaxTensor</a>[AxisType]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.tranform.unscale_jax_tensor">
<span class="sig-name descname"><span class="pre">unscale_jax_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaled_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><span class="pre">JaxTensor</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><span class="pre">JaxTensor</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/tranform.html#unscale_jax_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.tranform.unscale_jax_tensor" title="Link to this definition"></a></dt>
<dd><p>Reverse transformation of function <code class="docutils literal notranslate"><span class="pre">scale_jax_tensor</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><em>JaxTensor</em></a><em>[</em><em>AxisType</em><em>]</em>) – jax tensor to be unscaled</p></li>
<li><p><strong>scaling_factor</strong> (<em>jnp.ndarray</em>) – the scaling factors applied when scaling the original jax tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>unscaled jax tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor">JaxTensor</a>[AxisType]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JaxScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">scaling_factors:</span> <span class="pre">~jax.Array</span> <span class="pre">=</span> <span class="pre">Array(1.,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True),</span> <span class="pre">scaling_axes:</span> <span class="pre">~typing.Annotated[~typing.Set[~jax_utils.tranform.AxisType],</span> <span class="pre">'__jax_dataclasses_static_field__']</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">tensor_types_to_scale:</span> <span class="pre">~typing.Annotated[~typing.Tuple[~typing.Type[~jax_utils.jax_tensor.JaxTensor]],</span> <span class="pre">'__jax_dataclasses_static_field__']</span> <span class="pre">=</span> <span class="pre">(&lt;class</span> <span class="pre">'jax_utils.jax_tensor.JaxTensor'&gt;,),</span> <span class="pre">tensor_types_not_to_scale:</span> <span class="pre">~typing.Annotated[~typing.Tuple[~jax_utils.jax_tensor.JaxTensor],</span> <span class="pre">'__jax_dataclasses_static_field__']</span> <span class="pre">=</span> <span class="pre">()</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/tranform.html#JaxScaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.tranform.JaxScaler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.compilation.BaseJaxCompilable" title="jax_utils.compilation.BaseJaxCompilable"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseJaxCompilable</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>]</p>
<p>When applying gradient descent optimization algorithms, it is often helpful to scale all the arrays/tensors
involved in the computations.</p>
<p>This class allows to easily scale/unscale <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a>’s (even when
the tensors are stored in a nested pytree structure).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scaling_factors</strong> (<em>jnp.ndarray</em>) – Multiplicative factors for scaling. Default to <code class="docutils literal notranslate"><span class="pre">jnp.array(1.0)</span></code>.</p></li>
<li><p><strong>scaling_axes</strong> (<em>jdc.Static</em><em>[</em><em>Set</em><em>[</em><em>AxisType</em><em>]</em><em>]</em>) – “Named” axes of <code class="docutils literal notranslate"><span class="pre">scaling_factors</span></code>. Thus, the number of axes should
match <code class="docutils literal notranslate"><span class="pre">scaling_factors.ndim</span></code>. Default to <code class="docutils literal notranslate"><span class="pre">jdc.field(default_factory=set)</span></code>.</p></li>
<li><p><strong>tensor_types_to_scale</strong> (<em>jdc.Static</em><em>[</em><em>Tuple</em><em>[</em><em>Type</em><em>[</em><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><em>JaxTensor</em></a><em>]</em><em>]</em><em>]</em>) – Object types that should be scaled in a pytree.
Default to <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a>.</p></li>
<li><p><strong>tensor_types_not_to_scale</strong> (<em>jdc.Static</em><em>[</em><em>Tuple</em><em>[</em><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><em>JaxTensor</em></a><em>]</em><em>]</em>) – Object types that should not be scaled in a pytree.
Default to <code class="docutils literal notranslate"><span class="pre">tuple()</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.scaling_factors">
<span class="sig-name descname"><span class="pre">scaling_factors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array(1.,</span> <span class="pre">dtype=float32,</span> <span class="pre">weak_type=True)</span></em><a class="headerlink" href="#jax_utils.tranform.JaxScaler.scaling_factors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.scaling_axes">
<span class="sig-name descname"><span class="pre">scaling_axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.tranform.JaxScaler.scaling_axes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.tensor_types_to_scale">
<span class="sig-name descname"><span class="pre">tensor_types_to_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><span class="pre">JaxTensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(&lt;class</span> <span class="pre">'jax_utils.jax_tensor.JaxTensor'&gt;,)</span></em><a class="headerlink" href="#jax_utils.tranform.JaxScaler.tensor_types_to_scale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.tensor_types_not_to_scale">
<span class="sig-name descname"><span class="pre">tensor_types_not_to_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Annotated</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><span class="pre">JaxTensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'__jax_dataclasses_static_field__'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></em><a class="headerlink" href="#jax_utils.tranform.JaxScaler.tensor_types_not_to_scale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.from_tensor">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tensor:</span> <span class="pre">~jax_utils.jax_tensor.JaxTensor[~jax_utils.tranform.AxisType],</span> <span class="pre">scaling_axes:</span> <span class="pre">~typing.Set[~jax_utils.tranform.AxisType],</span> <span class="pre">tensor_types_to_scale:</span> <span class="pre">~typing.Annotated[~typing.Tuple[~typing.Type[~jax_utils.jax_tensor.JaxTensor]],</span> <span class="pre">'__jax_dataclasses_static_field__']</span> <span class="pre">=</span> <span class="pre">(&lt;class</span> <span class="pre">'jax_utils.jax_tensor.JaxTensor'&gt;,),</span> <span class="pre">tensor_types_not_to_scale:</span> <span class="pre">~typing.Annotated[~typing.Tuple[~jax_utils.jax_tensor.JaxTensor],</span> <span class="pre">'__jax_dataclasses_static_field__']</span> <span class="pre">=</span> <span class="pre">(),</span> <span class="pre">factor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jax_utils.tranform.JaxScaler" title="jax_utils.tranform.JaxScaler"><span class="pre">JaxScaler</span></a></span></span><a class="reference internal" href="../_modules/jax_utils/tranform.html#JaxScaler.from_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.tranform.JaxScaler.from_tensor" title="Link to this definition"></a></dt>
<dd><p>Alternative constructor that automatically computes the <code class="docutils literal notranslate"><span class="pre">scaling_factors</span></code> based on a
<a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a>, the <code class="docutils literal notranslate"><span class="pre">scaling_axes</span></code>  and a target <code class="docutils literal notranslate"><span class="pre">factor</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">my_scaler</span> <span class="pre">=</span> <span class="pre">JaxScaler.from_tensor(tensor=my_tensor,</span> <span class="pre">scaling_axes=my_axes,</span> <span class="pre">factor=my_factor)</span></code> then
<code class="docutils literal notranslate"><span class="pre">my_scaler.scale(my_tensor)</span></code> will be a <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a> with
<code class="docutils literal notranslate"><span class="pre">my_tensor.mean_over_axes(axes=my_axes)</span></code> being equal to a “constant” Jax array with all elements equal to
<code class="docutils literal notranslate"><span class="pre">my_factor</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><em>JaxTensor</em></a><em>[</em><em>AxisType</em><em>]</em>) – a jax tensor</p></li>
<li><p><strong>scaling_axes</strong> (<em>Set</em><em>[</em><em>AxisType</em><em>]</em>) – a set of “named” axes present in <cite>tensor</cite></p></li>
<li><p><strong>tensor_types_to_scale</strong> (<em>jdc.Static</em><em>[</em><em>Tuple</em><em>[</em><em>Type</em><em>[</em><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><em>JaxTensor</em></a><em>]</em><em>]</em><em>]</em>) – Object types that should be scaled in a pytree.
Default to <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a>.</p></li>
<li><p><strong>tensor_types_not_to_scale</strong> (<em>jdc.Static</em><em>[</em><em>Tuple</em><em>[</em><a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><em>JaxTensor</em></a><em>]</em><em>]</em>) – Object types that should not be scaled in a
pytree. Default to <code class="docutils literal notranslate"><span class="pre">tuple()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a scaler instance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jax_utils.tranform.JaxScaler" title="jax_utils.tranform.JaxScaler">JaxScaler</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pytree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/tranform.html#JaxScaler.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.tranform.JaxScaler.scale" title="Link to this definition"></a></dt>
<dd><p>Scales any pytree containing <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a>’s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pytree</strong> (<em>Any</em>) – pytree to be scaled</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the scaled pytree</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.unscale">
<span class="sig-name descname"><span class="pre">unscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaled_pytree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/jax_utils/tranform.html#JaxScaler.unscale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.tranform.JaxScaler.unscale" title="Link to this definition"></a></dt>
<dd><p>Unscales any pytree containing <a class="reference internal" href="#jax_utils.jax_tensor.JaxTensor" title="jax_utils.jax_tensor.JaxTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.jax_tensor.JaxTensor</span></code></a>’s (reverse
transformation of method <code class="docutils literal notranslate"><span class="pre">scale</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scaled_pytree</strong> (<em>Any</em>) – pytree to be unscaled</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the unscaled pytree</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.tranform.JaxScaler.expand_scaling_factors">
<span class="sig-name descname"><span class="pre">expand_scaling_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jax_utils.common_tensor.TensorAxes" title="jax_utils.common_tensor.TensorAxes"><span class="pre">TensorAxes</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisType</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="../_modules/jax_utils/tranform.html#JaxScaler.expand_scaling_factors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.tranform.JaxScaler.expand_scaling_factors" title="Link to this definition"></a></dt>
<dd><p>Expands the dimensions of <code class="docutils literal notranslate"><span class="pre">self.scaling_factors</span></code> to match the <code class="docutils literal notranslate"><span class="pre">tensor_axes</span></code> given as inputs.</p>
<p>This method only adds new dimensions of size 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor_axes</strong> (<a class="reference internal" href="#jax_utils.common_tensor.TensorAxes" title="jax_utils.common_tensor.TensorAxes"><em>TensorAxes</em></a><em>[</em><em>AxisType</em><em>]</em>) – a set of “named” axes</p></li>
<li><p><strong>missing_axes</strong> (<em>Set</em><em>[</em><em>AxisType</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>same as <code class="docutils literal notranslate"><span class="pre">self.scaling_factors</span></code> but with (empty) additional dimensions.</dt><dd><p>The total number of dimensions of the returned array is equal to <code class="docutils literal notranslate"><span class="pre">len(tensor_axes)</span></code>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.typing">
<span id="jax-utils-typing-module"></span><h2>jax_utils.typing module<a class="headerlink" href="#module-jax_utils.typing" title="Link to this heading"></a></h2>
<p>Define useful types for package</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.typing.DataclassInstance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DataclassInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/typing.html#DataclassInstance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.typing.DataclassInstance" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Type for Python dataclasses (see <code class="docutils literal notranslate"><span class="pre">dataclasses.dataclass</span></code>).</p>
<p>This code is copy-pasted from <code class="docutils literal notranslate"><span class="pre">_typeshed</span></code> (but is simpler to import).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.typing.HashableIndexingOrSlicing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HashableIndexingOrSlicing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/typing.html#HashableIndexingOrSlicing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.typing.HashableIndexingOrSlicing" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.typing.DataclassInstance" title="jax_utils.typing.DataclassInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataclassInstance</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Hashable</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Python slices and lists (of indices) are not hashable in Python (slices are hashable for Python version &gt;= 3.12).
This is a shared interface for hashable slices and indices.</p>
<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.typing.HashableIndexingOrSlicing.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">slice</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.typing.HashableIndexingOrSlicing.values" title="Link to this definition"></a></dt>
<dd><p>Property returning index values in the form of a slice, an int (for singletons) or a list of int.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>index values</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[slice, int, List[int]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.typing.HashableSlicing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HashableSlicing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/typing.html#HashableSlicing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.typing.HashableSlicing" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.typing.HashableIndexingOrSlicing" title="jax_utils.typing.HashableIndexingOrSlicing"><code class="xref py py-class docutils literal notranslate"><span class="pre">HashableIndexingOrSlicing</span></code></a></p>
<p>Python slices are not hashable for Python version &lt; 3.12.
This class allows to define hashable slices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – initial value of the slice (included)</p></li>
<li><p><strong>stop</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – last value of the slice (excluded)</p></li>
<li><p><strong>step</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – step between values</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.typing.HashableSlicing.start">
<span class="sig-name descname"><span class="pre">start</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#jax_utils.typing.HashableSlicing.start" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.typing.HashableSlicing.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#jax_utils.typing.HashableSlicing.stop" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.typing.HashableSlicing.step">
<span class="sig-name descname"><span class="pre">step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#jax_utils.typing.HashableSlicing.step" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.typing.HashableSlicing.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">slice</span></em><a class="headerlink" href="#jax_utils.typing.HashableSlicing.values" title="Link to this definition"></a></dt>
<dd><p>Property returning index values in the form of a slice, an int (for singletons) or a list of int.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>index values</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[slice, int, List[int]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.typing.HashableIndexing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HashableIndexing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/typing.html#HashableIndexing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.typing.HashableIndexing" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.typing.HashableIndexingOrSlicing" title="jax_utils.typing.HashableIndexingOrSlicing"><code class="xref py py-class docutils literal notranslate"><span class="pre">HashableIndexingOrSlicing</span></code></a></p>
<p>Python lists are not hashable.
This class allows to define hashable list of indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>Tuple</em><em>[</em><em>int</em><em>]</em><em>]</em>) – index or list of (integer-valued) indices</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.typing.HashableIndexing.indices">
<span class="sig-name descname"><span class="pre">indices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.typing.HashableIndexing.indices" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_utils.typing.HashableIndexing.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jax_utils.typing.HashableIndexing.values" title="Link to this definition"></a></dt>
<dd><p>Property returning index values in the form of a slice, an int (for singletons) or a list of int.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>index values</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[slice, int, List[int]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils.vectorization">
<span id="jax-utils-vectorization-module"></span><h2>jax_utils.vectorization module<a class="headerlink" href="#module-jax_utils.vectorization" title="Link to this heading"></a></h2>
<p>Classes and methods to easily vectorize jax tensors</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.vectorization.JaxVectorizableProtocol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JaxVectorizableProtocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/vectorization.html#JaxVectorizableProtocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.vectorization.JaxVectorizableProtocol" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.compilation.JaxCompilableProtocol" title="jax_utils.compilation.JaxCompilableProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxCompilableProtocol</span></code></a>, <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Interface for classes manipulating JAX arrays. It defines a special attribute <code class="docutils literal notranslate"><span class="pre">vectorized_axis</span></code>
corresponding to the “named” axis over which to apply
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html">vectorization</a>.</p>
<p>“Vectorizable” classes are also “compilable” (see interface
<a class="reference internal" href="#jax_utils.compilation.JaxCompilableProtocol" title="jax_utils.compilation.JaxCompilableProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.compilation.JaxCompilableProtocol</span></code></a>) and convertible to axes (see
<a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes</span></code></a> interface).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vectorized_axis</strong> (<em>AxisType</em>) – “named” axis to be vectorized</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jax_utils.vectorization.JaxVectorizableProtocol.vectorized_axis">
<span class="sig-name descname"><span class="pre">vectorized_axis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AxisType</span></em><a class="headerlink" href="#jax_utils.vectorization.JaxVectorizableProtocol.vectorized_axis" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_utils.vectorization.vectorize">
<span class="sig-name descname"><span class="pre">vectorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_default_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_default_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jax_utils/vectorization.html#vectorize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.vectorization.vectorize" title="Link to this definition"></a></dt>
<dd><p>Parametrized decorator for methods of classes implementing <a class="reference internal" href="#jax_utils.vectorization.JaxVectorizableProtocol" title="jax_utils.vectorization.JaxVectorizableProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxVectorizableProtocol</span></code></a>
interface. It allows to
<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html">vectorize</a>
the decorated methods according to a specified axis, namely attribute
<a class="reference internal" href="#jax_utils.vectorization.JaxVectorizableProtocol.vectorized_axis" title="jax_utils.vectorization.JaxVectorizableProtocol.vectorized_axis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">JaxVectorizableProtocol.vectorized_axis</span></code></a> (see <a class="reference internal" href="#jax_utils.vectorization.JaxVectorizableProtocol" title="jax_utils.vectorization.JaxVectorizableProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">JaxVectorizableProtocol</span></code></a>).</p>
<p>The <a class="reference external" href="https://jax.readthedocs.io/en/latest/pytrees.html">pytrees</a> of all inputs and outputs of the decorated
method are explored and every JAX array as well as every class implementing the
<a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes</span></code></a> interface is considered a leaf of the pytree.
When a <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes</span></code></a> leaf  is encountered, method
<a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes.convert_to_axes" title="jax_utils.pytree.ConvertibleToAxes.convert_to_axes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes.convert_to_axes()</span></code></a>
is used to determine the dimension to vectorize. When a JAX array leaf or any other leaf is encountered instead,
the default value <code class="docutils literal notranslate"><span class="pre">in_default_axis</span></code> (for input arguments) or <code class="docutils literal notranslate"><span class="pre">out_default_axis</span></code> (for output arguments) is used
to determine the dimension to vectorize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_default_axis</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – <p>default index used in <code class="docutils literal notranslate"><span class="pre">in_axes</span></code> argument of method
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html">jax.vmap</a>
when a leaf that is not <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes</span></code></a> is encountered
in an input pytree. Defaults to None.</p>
</p></li>
<li><p><strong>out_default_axis</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – <p>default index used in <code class="docutils literal notranslate"><span class="pre">out_axes</span></code> argument of method
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html">jax.vmap</a> when a leaf that is not
<a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax_utils.pytree.ConvertibleToAxes</span></code></a> is encountered in an output pytree.
Defaults to -1.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>decorator with parameters <code class="docutils literal notranslate"><span class="pre">in_default_axis</span></code> and <code class="docutils literal notranslate"><span class="pre">out_default_axis</span></code> specified</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[Callable], Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JaxDataclassNestedConvertibleToAxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_utils/vectorization.html#JaxDataclassNestedConvertibleToAxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jax_utils.typing.DataclassInstance" title="jax_utils.typing.DataclassInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataclassInstance</span></code></a>, <a class="reference internal" href="#jax_utils.pytree.ConvertibleToAxes" title="jax_utils.pytree.ConvertibleToAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>], <a class="reference internal" href="#jax_utils.compilation.BaseJaxCompilable" title="jax_utils.compilation.BaseJaxCompilable"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseJaxCompilable</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">AxisType_contra</span></code>]</p>
<p>Interface for dataclasses that can be jit-compiled and are “convertible to axes”, with a concrete implementation
of <code class="docutils literal notranslate"><span class="pre">convert_to_axes</span></code> method that is specific to dataclasses.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes.convert_to_axes">
<span class="sig-name descname"><span class="pre">convert_to_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AxisType_contra</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/jax_utils/vectorization.html#JaxDataclassNestedConvertibleToAxes.convert_to_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_utils.vectorization.JaxDataclassNestedConvertibleToAxes.convert_to_axes" title="Link to this definition"></a></dt>
<dd><p>Concrete implementation of <code class="docutils literal notranslate"><span class="pre">convert_to_axes</span></code> for dataclasses.
All the fields of the dataclass are inspected and method <code class="docutils literal notranslate"><span class="pre">convert_to_axes</span></code>
is applied whenever the field is <code class="docutils literal notranslate"><span class="pre">ConvertibleToAxes</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>Optional</em><em>[</em><em>AxisType_contra</em><em>]</em>) – a “named” axis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>same object as <code class="docutils literal notranslate"><span class="pre">self</span></code> but with array-like fields converted to axes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jax_utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-jax_utils" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="jax_utils" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, AI-Helpers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>